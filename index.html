<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Client Acquisition Tracking Worksheet</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable@14.3.0/dist/handsontable.full.min.css">
  <script src="https://cdn.jsdelivr.net/npm/handsontable@14.3.0/dist/handsontable.full.min.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Inter:400,600&display=swap" rel="stylesheet">
  <style>
    body {
      background: #222326;
      color: #222326;
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    .container {
      max-width: 1200px;
      margin: 40px auto 0 auto;
      background: #f3c846;
      border-radius: 18px;
      box-shadow: 0 8px 32px rgba(34,35,38,0.13);
      padding: 36px 40px 32px 40px;
      min-height: 700px;
      position: relative;
      border: 2px solid #bfa431;
    }
    h1 {
      text-align: center;
      color: #222326;
      margin-bottom: 32px;
      font-size: 2.5rem;
      letter-spacing: 2px;
      font-weight: 700;
    }
    .toolbar {
      display: flex;
      gap: 16px;
      margin-bottom: 26px;
      justify-content: flex-end;
    }
    .toolbar button {
      background: #222326;
      color: #f3c846;
      border: none;
      border-radius: 7px;
      padding: 10px 22px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s;
      font-weight: 600;
      letter-spacing: 0.5px;
      box-shadow: 0 2px 8px rgba(34,35,38,0.09);
    }
    .toolbar button:hover {
      background: #44474b;
    }
    .summary-bar {
      display: flex;
      gap: 28px;
      margin-bottom: 26px;
      justify-content: flex-start;
      flex-wrap: wrap;
    }
    .summary-card {
      background: #222326;
      color: #f3c846;
      border-radius: 10px;
      padding: 18px 32px;
      min-width: 180px;
      font-size: 1.14rem;
      font-weight: 500;
      box-shadow: 0 2px 8px rgba(34,35,38,0.10);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .summary-card .summary-number {
      color: #00cfff;
      font-size: 1.25em;
      font-weight: 700;
      margin-left: 8px;
    }
    #hot {
      margin-bottom: 100px;
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(34,35,38,0.13);
    }
    .ht_master .htCore thead th {
      background: #222326 !important;
      color: #f3c846 !important;
      font-size: 1.07rem;
      font-weight: 700;
      border-bottom: 2px solid #bfa431 !important;
      letter-spacing: 0.5px;
    }
    .ht_master .htCore td {
      background: #fffbe9 !important;
      color: #222326 !important;
      font-size: 1rem;
      border-bottom: 1px solid #bfa431 !important;
    }
    .priority-pill {
      display: inline-block;
      padding: 3px 18px;
      border-radius: 16px;
      font-size: 1em;
      font-weight: 600;
      text-align: center;
      letter-spacing: 0.5px;
      background: #bfa431;
      color: #fff;
      border: 1.5px solid #bfa431;
      box-shadow: 0 1px 4px rgba(34,35,38,0.11);
    }
    .priority-pill.high {
      background: #e53935;
      border-color: #e53935;
      color: #fff;
    }
    .priority-pill.medium {
      background: #f3c846;
      border-color: #bfa431;
      color: #222326;
    }
    .priority-pill.low {
      background: #44474b;
      border-color: #44474b;
      color: #fff;
    }
    .bottom-space {
      height: 100px;
      background: transparent;
    }
    @media (max-width: 800px) {
      .container { padding: 10px; }
      h1 { font-size: 1.5rem; }
      .summary-card { min-width: 120px; padding: 12px 10px; font-size: 0.95rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Client Acquisition Tracking Worksheet</h1>
    <div class="toolbar">
      <button onclick="addRow()">+ Add Row</button>
      <button onclick="addSector()">+ Add Sector</button>
      <button onclick="addStatus()">+ Add Status</button>
    </div>
    <div class="summary-bar" id="summaryBar"></div>
    <div id="hot"></div>
    <div class="bottom-space"></div>
  </div>
<script>
  // Initial dropdown options
  let sectorOptions = [
    'Food/Ice Creams',
    'Jewellers',
    'Apparel'
  ];
  let statusOptions = [
    'Not Contacted',
    'Contacted',
    'Follow-up Required',
    'Interested',
    'Not Interested',
    'Quote',
    'Success'
  ];
  const priorityOptions = ['Low', 'Medium', 'High'];

  // Initial data
  let data = [
    ['Good Flipping Burgers', 'Food/Ice Creams', '', '', '', '', '', '', 'High', '', ''],
    ['Serial Grillers', 'Food/Ice Creams', '', '', '', '', '', '', 'Medium', '', ''],
    ['GO zero ice creams', 'Food/Ice Creams', '', '', '', '', '', '', 'High', '', ''],
    ['Jet Gems', 'Jewellers', '', '', '', '', '', '', 'Medium', '', ''],
    ['Zen Diamonds', 'Jewellers', '', '', '', '', '', '', 'High', '', ''],
    ['Razwada Polki Jadau & Diamond Jewellery', 'Jewellers', '', '', '', '', '', '', 'Medium', '', ''],
    ['MK Jewels', 'Jewellers', '', '', '', '', '', '', 'Medium', '', ''],
    ['Mehta Brothers Jewellers', 'Jewellers', '', '', '', '', '', '', 'High', '', ''],
    ['Irasva Fine Jewellery', 'Jewellers', '', '', '', '', '', '', 'Medium', '', ''],
    ['Popley Jewellers', 'Jewellers', '', '', '', '', '', '', 'High', '', ''],
    ['Popley Eternal', 'Jewellers', '', '', '', '', '', '', 'Medium', '', ''],
    ['Minawala Jewellers', 'Jewellers', '', '', '', '', '', '', 'High', '', ''],
    ['Amrapali Jaipur', 'Jewellers', '', '', '', '', '', '', 'High', '', ''],
    ['Asuka', 'Apparel', '', '', '', '', '', '', 'Medium', '', ''],
    ['Kakli', 'Apparel', '', '', '', '', '', '', 'Medium', '', ''],
    ['House Of Anita Dongre Private Limited', 'Apparel', '', '', '', '', '', '', 'High', '', ''],
    ['Varuna D Jani - The Designer Atelier', 'Apparel', '', '', '', '', '', '', 'Medium', '', '']
  ];

  // Load from localStorage for persistence
  if (localStorage.getItem('vppcas-data')) {
    data = JSON.parse(localStorage.getItem('vppcas-data'));
  }
  if (localStorage.getItem('vppcas-sectors')) {
    sectorOptions = JSON.parse(localStorage.getItem('vppcas-sectors'));
  }
  if (localStorage.getItem('vppcas-statuses')) {
    statusOptions = JSON.parse(localStorage.getItem('vppcas-statuses'));
  }

  // Handsontable instance
  const container = document.getElementById('hot');
  const hot = new Handsontable(container, {
    data: data,
    colHeaders: [
      'Client Name',
      'Sector',
      'Address',
      'Phone',
      'Email',
      'Contact Person',
      'Status',
      'Last Contact',
      'Next Follow-up',
      'Priority',
      'Notes'
    ],
    columns: [
      { type: 'text' }, // Client Name
      { type: 'dropdown', source: sectorOptions, strict: false, allowInvalid: false }, // Sector
      { type: 'text' }, // Address
      { type: 'text' }, // Phone
      { type: 'text' }, // Email
      { type: 'text' }, // Contact Person
      { type: 'dropdown', source: statusOptions, strict: false, allowInvalid: false }, // Status
      { type: 'date', dateFormat: 'YYYY-MM-DD', correctFormat: true, allowInvalid: false }, // Last Contact
      { type: 'date', dateFormat: 'YYYY-MM-DD', correctFormat: true, allowInvalid: false }, // Next Follow-up
      { 
        type: 'dropdown', 
        source: priorityOptions, 
        strict: false, 
        allowInvalid: false,
        renderer: priorityRenderer
      }, // Priority
      { type: 'text' } // Notes
    ],
    stretchH: 'all',
    width: '100%',
    height: 600,
    manualColumnResize: true,
    manualRowResize: true,
    rowHeaders: true,
    contextMenu: true,
    licenseKey: 'non-commercial-and-evaluation',
    afterChange: function() {
      localStorage.setItem('vppcas-data', JSON.stringify(hot.getData()));
      updateSummary();
    },
    cells: function(row, col) {
      var cellProperties = {};
      if (col === 9) { // Priority column
        cellProperties.renderer = priorityRenderer;
      }
      return cellProperties;
    }
  });

  // Custom renderer for Priority column
  function priorityRenderer(instance, td, row, col, prop, value, cellProperties) {
    Handsontable.renderers.TextRenderer.apply(this, arguments);
    td.className = 'priority-pill';
    if (value === 'High') {
      td.className += ' high';
      td.textContent = 'High';
    } else if (value === 'Medium') {
      td.className += ' medium';
      td.textContent = 'Medium';
    } else if (value === 'Low') {
      td.className += ' low';
      td.textContent = 'Low';
    } else {
      td.className = '';
    }
  }

  // Add Row
  function addRow() {
    hot.alter('insert_row');
    updateSummary();
  }

  // Add Sector
  function addSector() {
    let sector = prompt("Enter new sector name:");
    if (!sector) return;
    sector = sector.trim();
    if (!sector) return;
    if (!sectorOptions.includes(sector)) {
      sectorOptions.push(sector);
      hot.updateSettings({
        columns: [
          { type: 'text' },
          { type: 'dropdown', source: sectorOptions, strict: false, allowInvalid: false },
          { type: 'text' },
          { type: 'text' },
          { type: 'text' },
          { type: 'text' },
          { type: 'dropdown', source: statusOptions, strict: false, allowInvalid: false },
          { type: 'date', dateFormat: 'YYYY-MM-DD', correctFormat: true, allowInvalid: false },
          { type: 'date', dateFormat: 'YYYY-MM-DD', correctFormat: true, allowInvalid: false },
          { type: 'dropdown', source: priorityOptions, strict: false, allowInvalid: false, renderer: priorityRenderer },
          { type: 'text' }
        ]
      });
      localStorage.setItem('vppcas-sectors', JSON.stringify(sectorOptions));
      alert('Sector added! Now available in every row.');
    } else {
      alert('That sector already exists.');
    }
  }

  // Add Status
  function addStatus() {
    let status = prompt("Enter new status:");
    if (!status) return;
    status = status.trim();
    if (!status) return;
    if (!statusOptions.includes(status)) {
      statusOptions.push(status);
      hot.updateSettings({
        columns: [
          { type: 'text' },
          { type: 'dropdown', source: sectorOptions, strict: false, allowInvalid: false },
          { type: 'text' },
          { type: 'text' },
          { type: 'text' },
          { type: 'text' },
          { type: 'dropdown', source: statusOptions, strict: false, allowInvalid: false },
          { type: 'date', dateFormat: 'YYYY-MM-DD', correctFormat: true, allowInvalid: false },
          { type: 'date', dateFormat: 'YYYY-MM-DD', correctFormat: true, allowInvalid: false },
          { type: 'dropdown', source: priorityOptions, strict: false, allowInvalid: false, renderer: priorityRenderer },
          { type: 'text' }
        ]
      });
      localStorage.setItem('vppcas-statuses', JSON.stringify(statusOptions));
      alert('Status added! Now available in every row.');
    } else {
      alert('That status already exists.');
    }
  }

  // Summary Bar
  function updateSummary() {
    const tableData = hot.getData();
    let total = 0, notContacted = 0, contacted = 0, highPriority = 0;
    tableData.forEach(row => {
      if (row[0]) total++;
      if (row[6] === 'Not Contacted') notContacted++;
      if (row[6] === 'Contacted') contacted++;
      if (row[9] === 'High') highPriority++;
    });
    document.getElementById('summaryBar').innerHTML = `
      <div class="summary-card">Total Clients: <span class="summary-number">${total}</span></div>
      <div class="summary-card">Not Contacted: <span class="summary-number">${notContacted}</span></div>
      <div class="summary-card">Contacted: <span class="summary-number">${contacted}</span></div>
      <div class="summary-card">High Priority: <span class="summary-number">${highPriority}</span></div>
    `;
  }
  updateSummary();
</script>
</body>
</html>



  

    
 

 

  
     
          



   
    
      
